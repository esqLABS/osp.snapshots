<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Creating and Managing Building Blocks • osp.snapshots</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Creating and Managing Building Blocks">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">osp.snapshots</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.2.1.9003</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/osp-snapshots.html">Get started</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/working-with-dataframes.html">Working with Data Frames</a></li>
    <li><a class="dropdown-item" href="../articles/creating-building-blocks.html">Creating Building Blocks</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Creating and Managing Building Blocks</h1>
            
      

      <div class="d-none name"><code>creating-building-blocks.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://esqlabs.github.io/osp.snapshots/">osp.snapshots</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/open-systems-pharmacology/ospsuite-r" class="external-link">ospsuite</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette demonstrates how to create new building blocks from
scratch and manage existing ones within snapshots. You’ll learn to:</p>
<ul>
<li>Create individuals, formulations, and parameters</li>
<li>Add and remove building blocks from snapshots</li>
<li>Work with observed data</li>
<li>Manage collections efficiently</li>
</ul>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Let’s start with a test snapshot:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">snapshot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_snapshot.html">load_snapshot</a></span><span class="op">(</span><span class="st">"Midazolam"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="creating-new-individuals">Creating New Individuals<a class="anchor" aria-label="anchor" href="#creating-new-individuals"></a>
</h2>
<div class="section level3">
<h3 id="basic-individual-creation">Basic Individual Creation<a class="anchor" aria-label="anchor" href="#basic-individual-creation"></a>
</h3>
<p>The most common building block to create is an individual:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a basic individual</span></span>
<span><span class="va">new_patient</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_individual.html">create_individual</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Patient_001"</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"Human"</span>,</span>
<span>  population <span class="op">=</span> <span class="st">"European_ICRP_2002"</span>,</span>
<span>  gender <span class="op">=</span> <span class="st">"FEMALE"</span>,</span>
<span>  age <span class="op">=</span> <span class="fl">35</span>,</span>
<span>  weight <span class="op">=</span> <span class="fl">65</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">165</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">new_patient</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Individual: Patient_001</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Characteristics</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • Species: Human</span></span>
<span><span class="co">#&gt; • Population: European_ICRP_2002</span></span>
<span><span class="co">#&gt; • Gender: FEMALE</span></span>
<span><span class="co">#&gt; • Age: 35 year(s)</span></span>
<span><span class="co">#&gt; • Height: 165 cm</span></span>
<span><span class="co">#&gt; • Weight: 65 kg</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="advanced-individual-creation">Advanced Individual Creation<a class="anchor" aria-label="anchor" href="#advanced-individual-creation"></a>
</h3>
<p>You can create individuals with additional parameters:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create individual with more characteristics</span></span>
<span><span class="va">advanced_patient</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_individual.html">create_individual</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Pregnant_Patient"</span>,</span>
<span>  species <span class="op">=</span> <span class="st">"Human"</span>,</span>
<span>  population <span class="op">=</span> <span class="st">"European_ICRP_2002"</span>,</span>
<span>  gender <span class="op">=</span> <span class="st">"FEMALE"</span>,</span>
<span>  age <span class="op">=</span> <span class="fl">28</span>,</span>
<span>  weight <span class="op">=</span> <span class="fl">70</span>,</span>
<span>  height <span class="op">=</span> <span class="fl">168</span>,</span>
<span>  gestational_age <span class="op">=</span> <span class="fl">20</span> <span class="co"># weeks</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">advanced_patient</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Individual: Pregnant_Patient</span> <span style="color: #00BBBB;">────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Characteristics</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • Species: Human</span></span>
<span><span class="co">#&gt; • Population: European_ICRP_2002</span></span>
<span><span class="co">#&gt; • Gender: FEMALE</span></span>
<span><span class="co">#&gt; • Age: 28 year(s)</span></span>
<span><span class="co">#&gt; • Gestational Age: 20 week(s)</span></span>
<span><span class="co">#&gt; • Height: 168 cm</span></span>
<span><span class="co">#&gt; • Weight: 70 kg</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="adding-individuals-to-snapshots">Adding Individuals to Snapshots<a class="anchor" aria-label="anchor" href="#adding-individuals-to-snapshots"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add the new individual to the snapshot</span></span>
<span><span class="fu"><a href="../reference/add_individual.html">add_individual</a></span><span class="op">(</span><span class="va">snapshot</span>, <span class="va">new_patient</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Verify it was added</span></span>
<span><span class="va">snapshot</span><span class="op">$</span><span class="va">individuals</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Individuals (3)</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; • European (P-gp modified, CYP3A4 36 h)</span></span>
<span><span class="co">#&gt; • Korean (Yu 2004 study)</span></span>
<span><span class="co">#&gt; • Patient_001</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="creating-new-formulations">Creating New Formulations<a class="anchor" aria-label="anchor" href="#creating-new-formulations"></a>
</h2>
<div class="section level3">
<h3 id="dissolved-formulations">Dissolved Formulations<a class="anchor" aria-label="anchor" href="#dissolved-formulations"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a simple dissolved formulation</span></span>
<span><span class="va">oral_solution</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_formulation.html">create_formulation</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Oral Solution 10mg/mL"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"Dissolved"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">oral_solution</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Formulation: Oral Solution 10mg/mL</span> <span style="color: #00BBBB;">──────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; • Type: Dissolved</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="tablet-formulations">Tablet Formulations<a class="anchor" aria-label="anchor" href="#tablet-formulations"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a tablet with Weibull dissolution</span></span>
<span><span class="va">tablet</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_formulation.html">create_formulation</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Immediate Release Tablet"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"Weibull"</span>,</span>
<span>  parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    dissolution_time <span class="op">=</span> <span class="fl">30</span>, <span class="co"># 50% dissolved in 30 min</span></span>
<span>    dissolution_time_unit <span class="op">=</span> <span class="st">"min"</span>,</span>
<span>    lag_time <span class="op">=</span> <span class="fl">5</span>, <span class="co"># 5 min lag time</span></span>
<span>    lag_time_unit <span class="op">=</span> <span class="st">"min"</span>,</span>
<span>    dissolution_shape <span class="op">=</span> <span class="fl">1.2</span>, <span class="co"># shape parameter</span></span>
<span>    suspension <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># use as suspension</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">tablet</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Formulation: Immediate Release Tablet</span> <span style="color: #00BBBB;">───────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; • Type: Weibull</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Parameters</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • Dissolution time (50% dissolved): 30 min</span></span>
<span><span class="co">#&gt; • Lag time: 5 min</span></span>
<span><span class="co">#&gt; • Dissolution shape: 1.2</span></span>
<span><span class="co">#&gt; • Use as suspension: 1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="additional-formulation-types">Additional Formulation Types<a class="anchor" aria-label="anchor" href="#additional-formulation-types"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a first-order formulation</span></span>
<span><span class="va">first_order_form</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_formulation.html">create_formulation</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"First Order Release"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"First Order"</span>,</span>
<span>  parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    thalf <span class="op">=</span> <span class="fl">60</span>,</span>
<span>    thalf_unit <span class="op">=</span> <span class="st">"min"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create a zero-order formulation</span></span>
<span><span class="va">zero_order_form</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_formulation.html">create_formulation</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Zero Order Release"</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"Zero Order"</span>,</span>
<span>  parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    end_time <span class="op">=</span> <span class="fl">120</span>,</span>
<span>    end_time_unit <span class="op">=</span> <span class="st">"min"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the formulations</span></span>
<span><span class="va">first_order_form</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Formulation: First Order Release</span> <span style="color: #00BBBB;">────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; • Type: First Order</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Parameters</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • t1/2: 60 min</span></span>
<span><span class="va">zero_order_form</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Formulation: Zero Order Release</span> <span style="color: #00BBBB;">─────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; • Type: Zero Order</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Parameters</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; • End time: 120 min</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="adding-formulations-to-snapshots">Adding Formulations to Snapshots<a class="anchor" aria-label="anchor" href="#adding-formulations-to-snapshots"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add formulations to the snapshot</span></span>
<span><span class="fu"><a href="../reference/add_formulation.html">add_formulation</a></span><span class="op">(</span><span class="va">snapshot</span>, <span class="va">oral_solution</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/add_formulation.html">add_formulation</a></span><span class="op">(</span><span class="va">snapshot</span>, <span class="va">tablet</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check they were added</span></span>
<span><span class="va">snapshot</span><span class="op">$</span><span class="va">formulations</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Formulations (4)</span> <span style="color: #00BBBB;">────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; • Oral solution (Dissolved)</span></span>
<span><span class="co">#&gt; • Tablet (Dormicum) (Weibull)</span></span>
<span><span class="co">#&gt; • Oral Solution 10mg/mL (Dissolved)</span></span>
<span><span class="co">#&gt; • Immediate Release Tablet (Weibull)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="creating-parameters">Creating Parameters<a class="anchor" aria-label="anchor" href="#creating-parameters"></a>
</h2>
<div class="section level3">
<h3 id="basic-parameter-creation">Basic Parameter Creation<a class="anchor" aria-label="anchor" href="#basic-parameter-creation"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a parameter with basic properties</span></span>
<span><span class="va">liver_param</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_parameter.html">create_parameter</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Organism|Liver|Specific organ clearance"</span>,</span>
<span>  value <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"1/min"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">liver_param</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Parameter: Organism|Liver|Specific organ clearance </span></span>
<span><span class="co">#&gt; • Value: 0.5</span></span>
<span><span class="co">#&gt; • Unit: 1/min</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="parameter-with-additional-properties">Parameter with Additional Properties<a class="anchor" aria-label="anchor" href="#parameter-with-additional-properties"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create parameter with source information</span></span>
<span><span class="va">detailed_param</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_parameter.html">create_parameter</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Organism|Kidney|GFR"</span>,</span>
<span>  value <span class="op">=</span> <span class="fl">120</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"ml/min"</span>,</span>
<span>  source <span class="op">=</span> <span class="st">"Literature"</span>,</span>
<span>  description <span class="op">=</span> <span class="st">"Normal adult GFR"</span>,</span>
<span>  source_id <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">detailed_param</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── Parameter: Organism|Kidney|GFR </span></span>
<span><span class="co">#&gt; • Value: 120</span></span>
<span><span class="co">#&gt; • Unit: ml/min</span></span>
<span><span class="co">#&gt; • Source: Literature</span></span>
<span><span class="co">#&gt; • Description: Normal adult GFR</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="managing-building-blocks">Managing Building Blocks<a class="anchor" aria-label="anchor" href="#managing-building-blocks"></a>
</h2>
<div class="section level3">
<h3 id="removing-building-blocks">Removing Building Blocks<a class="anchor" aria-label="anchor" href="#removing-building-blocks"></a>
</h3>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove individuals by name</span></span>
<span><span class="fu"><a href="../reference/remove_individual.html">remove_individual</a></span><span class="op">(</span><span class="va">snapshot</span>, <span class="st">"Patient_001"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove multiple individuals at once</span></span>
<span><span class="co"># remove_individual(snapshot, c("Patient_001", "Patient_002"))</span></span>
<span></span>
<span><span class="co"># Remove formulations</span></span>
<span><span class="fu"><a href="../reference/remove_formulation.html">remove_formulation</a></span><span class="op">(</span><span class="va">snapshot</span>, <span class="st">"Oral Solution 10mg/mL"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove populations</span></span>
<span><span class="co"># remove_population(snapshot, "Population_Name")</span></span>
<span></span>
<span><span class="co"># Remove expression profiles by ID (molecule|species|category)</span></span>
<span><span class="co"># remove_expression_profile(snapshot, "CYP3A4|Human|Healthy")</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="batch-operations">Batch Operations<a class="anchor" aria-label="anchor" href="#batch-operations"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create multiple individuals at once</span></span>
<span><span class="va">patients</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/create_individual.html">create_individual</a></span><span class="op">(</span><span class="st">"Patient_A"</span>, age <span class="op">=</span> <span class="fl">25</span>, gender <span class="op">=</span> <span class="st">"MALE"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/create_individual.html">create_individual</a></span><span class="op">(</span><span class="st">"Patient_B"</span>, age <span class="op">=</span> <span class="fl">45</span>, gender <span class="op">=</span> <span class="st">"FEMALE"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/create_individual.html">create_individual</a></span><span class="op">(</span><span class="st">"Patient_C"</span>, age <span class="op">=</span> <span class="fl">65</span>, gender <span class="op">=</span> <span class="st">"MALE"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add them all</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">patient</span> <span class="kw">in</span> <span class="va">patients</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/add_individual.html">add_individual</a></span><span class="op">(</span><span class="va">snapshot</span>, <span class="va">patient</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Verify</span></span>
<span><span class="va">snapshot</span><span class="op">$</span><span class="va">individuals</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Individuals (5)</span> <span style="color: #00BBBB;">─────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; • European (P-gp modified, CYP3A4 36 h)</span></span>
<span><span class="co">#&gt; • Korean (Yu 2004 study)</span></span>
<span><span class="co">#&gt; • Patient_A</span></span>
<span><span class="co">#&gt; • Patient_B</span></span>
<span><span class="co">#&gt; • Patient_C</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="working-with-observed-data">Working with Observed Data<a class="anchor" aria-label="anchor" href="#working-with-observed-data"></a>
</h2>
<div class="section level3">
<h3 id="creating-dataset-objects">Creating DataSet Objects<a class="anchor" aria-label="anchor" href="#creating-dataset-objects"></a>
</h3>
<p>Observed data must be provided as <code><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/DataSet.html" class="external-link">ospsuite::DataSet</a></code>
objects:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a new DataSet</span></span>
<span><span class="va">study_data</span> <span class="op">&lt;-</span> <span class="va"><a href="https://www.open-systems-pharmacology.org/OSPSuite-R/reference/DataSet.html" class="external-link">DataSet</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>name <span class="op">=</span> <span class="st">"Phase I Study - Subject 001"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set the data values</span></span>
<span><span class="va">time_points</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">12</span>, <span class="fl">24</span><span class="op">)</span></span>
<span><span class="va">concentrations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">12.5</span>, <span class="fl">18.2</span>, <span class="fl">15.8</span>, <span class="fl">11.2</span>, <span class="fl">6.8</span>, <span class="fl">3.4</span>, <span class="fl">1.1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">study_data</span><span class="op">$</span><span class="fu">setValues</span><span class="op">(</span>xValues <span class="op">=</span> <span class="va">time_points</span>, yValues <span class="op">=</span> <span class="va">concentrations</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set dimensions and units</span></span>
<span><span class="va">study_data</span><span class="op">$</span><span class="va">xDimension</span> <span class="op">&lt;-</span> <span class="st">"Time"</span></span>
<span><span class="va">study_data</span><span class="op">$</span><span class="va">xUnit</span> <span class="op">&lt;-</span> <span class="st">"h"</span></span>
<span><span class="va">study_data</span><span class="op">$</span><span class="va">yDimension</span> <span class="op">&lt;-</span> <span class="st">"Concentration (mass)"</span></span>
<span><span class="va">study_data</span><span class="op">$</span><span class="va">yUnit</span> <span class="op">&lt;-</span> <span class="st">"mg/l"</span></span>
<span></span>
<span><span class="va">study_data</span></span>
<span><span class="co">#&gt; <span style="color: #0000BB;">&lt;DataSet&gt;</span></span></span>
<span><span class="co">#&gt;   • Name: Phase I Study - Subject 001</span></span>
<span><span class="co">#&gt;   • X dimension: Time</span></span>
<span><span class="co">#&gt;   • X unit: h</span></span>
<span><span class="co">#&gt;   • Y dimension: Concentration (mass)</span></span>
<span><span class="co">#&gt;   • Y unit: mg/l</span></span>
<span><span class="co">#&gt;   • Error type: NULL</span></span>
<span><span class="co">#&gt;   • Error unit: NULL</span></span>
<span><span class="co">#&gt;   • Molecular weight: NULL</span></span>
<span><span class="co">#&gt;   • LLOQ: NULL</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Meta data</span>:</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="adding-observed-data">Adding Observed Data<a class="anchor" aria-label="anchor" href="#adding-observed-data"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add to snapshot (function needs to be implemented)</span></span>
<span><span class="co"># add_observed_data(snapshot, study_data)</span></span>
<span></span>
<span><span class="co"># Remove observed data by name</span></span>
<span><span class="co"># remove_observed_data(snapshot, "Phase I Study - Subject 001")</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="advanced-building-block-management">Advanced Building Block Management<a class="anchor" aria-label="anchor" href="#advanced-building-block-management"></a>
</h2>
<div class="section level3">
<h3 id="modifying-existing-building-blocks">Modifying Existing Building Blocks<a class="anchor" aria-label="anchor" href="#modifying-existing-building-blocks"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get an individual and modify properties</span></span>
<span><span class="va">patient</span> <span class="op">&lt;-</span> <span class="va">snapshot</span><span class="op">$</span><span class="va">individuals</span><span class="op">$</span><span class="va">`Patient_A`</span></span>
<span><span class="va">patient</span><span class="op">$</span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fl">30</span></span>
<span><span class="va">patient</span><span class="op">$</span><span class="va">weight</span> <span class="op">&lt;-</span> <span class="fl">75</span></span>
<span></span>
<span><span class="co"># Add custom parameters</span></span>
<span><span class="va">custom_param</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_parameter.html">create_parameter</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Organism|Custom|Clearance"</span>,</span>
<span>  value <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"L/h"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Note: Adding parameters to existing individuals requires</span></span>
<span><span class="co"># working with the parameter collection directly</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="copying-and-modifying-building-blocks">Copying and Modifying Building Blocks<a class="anchor" aria-label="anchor" href="#copying-and-modifying-building-blocks"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a copy of an existing individual with modifications</span></span>
<span><span class="va">original</span> <span class="op">&lt;-</span> <span class="va">snapshot</span><span class="op">$</span><span class="va">individuals</span><span class="op">$</span><span class="va">`European (P-gp modified, CYP3A4 36 h)`</span></span>
<span></span>
<span><span class="co"># Create modified copy</span></span>
<span><span class="va">modified_individual</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_individual.html">create_individual</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Modified European"</span>,</span>
<span>  species <span class="op">=</span> <span class="va">original</span><span class="op">$</span><span class="va">species</span>,</span>
<span>  population <span class="op">=</span> <span class="va">original</span><span class="op">$</span><span class="va">population</span>,</span>
<span>  gender <span class="op">=</span> <span class="va">original</span><span class="op">$</span><span class="va">gender</span>,</span>
<span>  age <span class="op">=</span> <span class="fl">50</span>, <span class="co"># Changed age</span></span>
<span>  weight <span class="op">=</span> <span class="fl">80</span> <span class="co"># Changed weight</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/add_individual.html">add_individual</a></span><span class="op">(</span><span class="va">snapshot</span>, <span class="va">modified_individual</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="validation-and-error-handling">Validation and Error Handling<a class="anchor" aria-label="anchor" href="#validation-and-error-handling"></a>
</h3>
<p>The package includes validation for common inputs:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># These will produce validation errors:</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>  <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/create_individual.html">create_individual</a></span><span class="op">(</span></span>
<span>      name <span class="op">=</span> <span class="st">"Invalid Patient"</span>,</span>
<span>      species <span class="op">=</span> <span class="st">"InvalidSpecies"</span>, <span class="co"># Invalid species</span></span>
<span>      gender <span class="op">=</span> <span class="st">"OTHER"</span> <span class="co"># Invalid gender</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Error:"</span>, <span class="va">e</span><span class="op">$</span><span class="va">message</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: Invalid species: InvalidSpecies</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span>
<span>  <span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/create_formulation.html">create_formulation</a></span><span class="op">(</span></span>
<span>      name <span class="op">=</span> <span class="st">"Invalid Form"</span>,</span>
<span>      type <span class="op">=</span> <span class="st">"NonexistentType"</span> <span class="co"># Invalid formulation type</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Error:"</span>, <span class="va">e</span><span class="op">$</span><span class="va">message</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Error: subscript out of bounds</span></span></code></pre></div>
<p>Valid options are available through validation functions:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check valid species (this would show available options)</span></span>
<span><span class="co"># validate_species("Human")  # Returns TRUE</span></span>
<span></span>
<span><span class="co"># Check valid genders</span></span>
<span><span class="co"># validate_gender("MALE")    # Returns TRUE</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="working-with-templates">Working with Templates<a class="anchor" aria-label="anchor" href="#working-with-templates"></a>
</h2>
<p>You can load predefined templates and modify them:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load a template (if available)</span></span>
<span><span class="co"># template_snapshot &lt;- load_snapshot("TemplateName")</span></span>
<span></span>
<span><span class="co"># Modify template building blocks</span></span>
<span><span class="co"># template_individual &lt;- template_snapshot$individuals[[1]]</span></span>
<span><span class="co"># template_individual$age &lt;- 40</span></span>
<span></span>
<span><span class="co"># Add to your snapshot</span></span>
<span><span class="co"># add_individual(snapshot, template_individual)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exporting-your-work">Exporting Your Work<a class="anchor" aria-label="anchor" href="#exporting-your-work"></a>
</h2>
<p>After creating and managing building blocks, export your
snapshot:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Export the modified snapshot</span></span>
<span><span class="fu"><a href="../reference/export_snapshot.html">export_snapshot</a></span><span class="op">(</span><span class="va">snapshot</span>, <span class="st">"modified_snapshot_with_new_blocks.json"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="best-practices">Best Practices<a class="anchor" aria-label="anchor" href="#best-practices"></a>
</h2>
<div class="section level3">
<h3 id="naming-conventions">Naming Conventions<a class="anchor" aria-label="anchor" href="#naming-conventions"></a>
</h3>
<p>Use descriptive names for building blocks:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Good naming</span></span>
<span><span class="fu"><a href="../reference/create_individual.html">create_individual</a></span><span class="op">(</span></span>
<span>  <span class="st">"Elderly_Female_80kg"</span>,</span>
<span>  age <span class="op">=</span> <span class="fl">75</span>,</span>
<span>  gender <span class="op">=</span> <span class="st">"FEMALE"</span>,</span>
<span>  weight <span class="op">=</span> <span class="fl">80</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/create_formulation.html">create_formulation</a></span><span class="op">(</span><span class="st">"IR_Tablet_Fast_Release"</span>, type <span class="op">=</span> <span class="st">"Weibull"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Less descriptive</span></span>
<span><span class="fu"><a href="../reference/create_individual.html">create_individual</a></span><span class="op">(</span><span class="st">"Patient1"</span>, age <span class="op">=</span> <span class="fl">75</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/create_formulation.html">create_formulation</a></span><span class="op">(</span><span class="st">"Form1"</span>, type <span class="op">=</span> <span class="st">"Weibull"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="organization">Organization<a class="anchor" aria-label="anchor" href="#organization"></a>
</h3>
<p>Keep related building blocks together:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a family of related individuals</span></span>
<span><span class="va">pediatric_patients</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/create_individual.html">create_individual</a></span><span class="op">(</span><span class="st">"Pediatric_5yr"</span>, age <span class="op">=</span> <span class="fl">5</span>, weight <span class="op">=</span> <span class="fl">18</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/create_individual.html">create_individual</a></span><span class="op">(</span><span class="st">"Pediatric_10yr"</span>, age <span class="op">=</span> <span class="fl">10</span>, weight <span class="op">=</span> <span class="fl">32</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/create_individual.html">create_individual</a></span><span class="op">(</span><span class="st">"Pediatric_15yr"</span>, age <span class="op">=</span> <span class="fl">15</span>, weight <span class="op">=</span> <span class="fl">55</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create related formulations</span></span>
<span><span class="va">pediatric_formulations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/create_formulation.html">create_formulation</a></span><span class="op">(</span><span class="st">"Oral_Suspension_Pediatric"</span>, type <span class="op">=</span> <span class="st">"Dissolved"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/create_formulation.html">create_formulation</a></span><span class="op">(</span><span class="st">"Chewable_Tablet_Pediatric"</span>, type <span class="op">=</span> <span class="st">"Weibull"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="documentation">Documentation<a class="anchor" aria-label="anchor" href="#documentation"></a>
</h3>
<p>Document your building blocks with meaningful metadata:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add comments or descriptions when creating parameters</span></span>
<span><span class="va">hepatic_clearance</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_parameter.html">create_parameter</a></span><span class="op">(</span></span>
<span>  name <span class="op">=</span> <span class="st">"Organism|Liver|Hepatic clearance"</span>,</span>
<span>  value <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  unit <span class="op">=</span> <span class="st">"L/h"</span>,</span>
<span>  description <span class="op">=</span> <span class="st">"Estimated from in vitro data scaled with ISEF=0.5"</span>,</span>
<span>  source <span class="op">=</span> <span class="st">"Laboratory study 2023"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="next-steps">Next Steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<ul>
<li>Explore data frame conversion in
<code><a href="../articles/working-with-dataframes.html">vignette("working-with-dataframes")</a></code>
</li>
<li>See the complete API reference at <a href="https://esqlabs.github.io/osp.snapshots/reference/">function
reference</a>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Felix MIL, ESQlabs, GmbH. Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

<div class="pkgdown-footer-right">
  <p>osp.snapshots</p>
</div>

    </footer>
</div>





  </body>
</html>
